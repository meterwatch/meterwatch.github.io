<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Meterwatch Demo Home Live monitor</title>
  <link rel="shortcut icon" type="image/png" href="assets/images/logos/favicon.png" />
  <link rel="stylesheet" href="assets/css/styles.min.css" />
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-GVRPV64YPR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-GVRPV64YPR');
    </script>
	<style>
		:root {
            --background: 240 10% 93%;
            --foreground: 256 24% 28%;
            --card: 0 0% 100%;
            --card-foreground: 256 24% 28%;
            --primary: 14 72% 45%;
            --primary-foreground: 0 0% 100%;
            --secondary: 256 24% 28%;
            --secondary-foreground: 240 10% 93%;
            --muted: 240 5% 96%;
            --muted-foreground: 256 8% 38%;
            --accent: 14 72% 45%;
            --accent-foreground: 0 0% 100%;
            --radius: 0.5rem;
            --bs-spinner-width: 2rem;
    		--bs-spinner-height: 2rem;
    		--bs-spinner-vertical-align: -0.125em;
    		--bs-spinner-border-color: currentColor;
    		--bs-spinner-animation-speed: 0.75s;
    		--bs-spinner-animation-name: spinner-grow;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
        }
		 .navbar {
            background-color: #3c3251;
            padding: 1rem 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .navbar-brand {
            color: #ececf0;
            font-size: 1.5rem;
            font-weight: bold;
            text-decoration: none;
        }

        .nav-link {
            color: #ececf0;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-link:hover {
            color: #c74e20;
        }
	</style>
	<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
	<link rel="manifest" href="site.webmanifest">
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MWC458DP');</script>
    <!-- End Google Tag Manager -->
</head>

<body>
  <!--  Body Wrapper -->
   <!-- Google Tag Manager (noscript) -->
   <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MWC458DP"height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
   <!-- End Google Tag Manager (noscript) -->
   <nav class="navbar navbar-expand-lg">
	   <div class="container">
		   <a class="navbar-brand" href="index.html">Meter Watch</a>
		   <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
			   <span class="navbar-toggler-icon"></span>
		   </button>
		   <div class="collapse navbar-collapse" id="navbarNav">
			   <ul class="navbar-nav ms-auto">
				   <li class="nav-item">
					   <a class="nav-link" href="index.html">Home |</a>
				   </li>
				   <li class="nav-item">
					   <!--<a class="nav-link" href="#">About</a>-->
				   </li>
				   <li class="nav-item">
					   <a class="nav-link" href="report.html">Energy Reports |</a>
				   </li>
				   <li class="nav-item">
					   <a class="nav-link" href="Loadshedding.html">LoadShedding Calendar |</a>
				   </li>
			   </ul>
		   </div>
	   </div>
   </nav>

  <div class="page-wrapper" id="main-wrapper" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
	data-sidebar-position="fixed" data-header-position="fixed">

	<!-- Navbar Start --
	<nav class="navbar navbar-expand-lg ">
		<div class="container-fluid"></div>
			<a class="navbar-brand" href="#">Meter Watch : Home Live Monitoring Demo</a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarNav">
				<ul class="navbar-nav ms-auto">
					<li class="nav-item">
						<a class="nav-link" href="#">Home</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="report.html">Energy Reports</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="Loadshedding.html">LoadShedding Calendar</a>
					</li>
				</ul>
			</div>
		</div>
	</nav>
	-- Navbar End --
	</nav>
	-- Navbar End -->


    <!--  Main wrapper -->
    <div class="body-wrapper">
      <!--  Header Start -->
      <header class="app-header">
        <!--<nav class="navbar navbar-expand-lg navbar-light">
          <ul class="navbar-nav">
            <li class="nav-item d-block d-xl-none">
              <a class="nav-link sidebartoggler nav-icon-hover" id="headerCollapse" href="javascript:void(0)">
                <i class="ti ti-menu-2"></i>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link nav-icon-hover" href="javascript:void(0)"></a>
            </li>
          </ul>
          <div class="navbar-collapse justify-content-end px-0" id="navbarNav">
            <ul class="navbar-nav flex-row ms-auto align-items-center justify-content-end">
              
            </ul>
          </div>
        </nav>-->
      </header>
      <!--  Header End -->
      <div class="container-fluid">
      	<!--   Row 3 -->
<div class="row">
  <!-- Load Percent Line Area Chart -->
  <div class="col-lg-6 d-flex align-items-stretch">
    <div class="card w-100">
      <div class="card-body">
        <div class="d-sm-flex d-block align-items-center justify-content-between mb-3">
          <div class="mb-3 mb-sm-0">
            <h5 class="card-title fw-semibold">
            Invetr Load (Percent)<br>
            Last Updated<br>
            KwH / Consumed / 24Hrs<br>
          </h5>
          </div>
        </div>
        <div id="loadPercentChart" style="width: 100%; height: 300px;"></div>
      </div>
    </div>
  </div>

  <!-- Power Usage vs. PV Generation Bar Chart -->
  <div class="col-lg-6 d-flex align-items-stretch">
    <div class="card w-100">
      <div class="card-body">
        <div class="d-sm-flex d-block align-items-center justify-content-between mb-3">
          <div class="mb-3 mb-sm-0">
            <h5 class="card-title fw-semibold">Power Usage vs. PV Generation</h5>
          </div>
        </div>
        <div id="powerUsageChart" style="width: 100%; height: 300px;"></div>
      </div>
    </div>
  </div>
</div>
<!--  End of Row 3 -->

       <!--  Row 1 -->
<div class="row">
  <!-- First Chart: Grid Power -->
  <div class="col-lg-6 d-flex align-items-stretch">
    <div class="card w-100">
      <div class="card-body">
        <div class="d-sm-flex d-block align-items-center justify-content-between mb-3">
          <div class="mb-3 mb-sm-0">
            <h5 class="card-title fw-semibold">Grid Power History</h5>
          </div>
        </div>
        <div id="gridPowerChart" style="width: 100%; height: 300px;"></div>
      </div>
    </div>
  </div>

  <!-- Second Chart: Charger Power -->
  <div class="col-lg-6 d-flex align-items-stretch">
    <div class="card w-100">
      <div class="card-body">
        <div class="d-sm-flex d-block align-items-center justify-content-between mb-3">
          <div class="mb-3 mb-sm-0">
            <h5 class="card-title fw-semibold">Charger Power History</h5>
          </div>
        </div>
        <div id="chargerPowerChart" style="width: 100%; height: 300px;"></div>
      </div>
    </div>
  </div>
</div>

<!--  End of Row 1 -->

<!--  Row 2 -->
<div class="row">
  <div class="col-lg-6 d-flex align-items-stretch">
    <div class="card w-100">
      <div class="card-body">
        <div class="d-sm-flex d-block align-items-center justify-content-between mb-3">
          <div class="mb-3 mb-sm-0">
            <h5 class="card-title fw-semibold">Current Levels</h5>
          </div>
        </div>
        <div id="currentChart" style="width: 100%; height: 300px;"></div>
      </div>
    </div>
  </div>
  
  <div class="col-lg-6 d-flex align-items-stretch">
    <div class="card w-100">
      <div class="card-body">
        <div class="d-sm-flex d-block align-items-center justify-content-between mb-3">
          <div class="mb-3 mb-sm-0">
            <h5 class="card-title fw-semibold">Voltage Levels</h5>
          </div>
        </div>
        <div id="voltageChart" style="width: 100%; height: 300px;"></div>
      </div>
    </div>
  </div>
</div>

<!--  End of Row 2 -->



  

       
        <div class="py-6 px-6 text-center">
         
        </div>
      </div>
    </div>
  </div>
  <script src="assets/libs/jquery/dist/jquery.min.js"></script>
  <script src="assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
  <script src="assets/js/sidebarmenu.js"></script>
  <script src="assets/js/app.min.js"></script>
  <script src="assets/libs/apexcharts/dist/apexcharts.min.js"></script>
  <script src="assets/libs/simplebar/dist/simplebar.js"></script>
  <script src="assets/js/dashboard.js"></script>
  <script src="assets/js/axios.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/socket.io-client/dist/socket.io.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>



<script type="text/javascript">
function maintainArrayLength(array, maxLength) {
  //console.log(array)
  if (array.length >= maxLength) {
    array.shift(); // Remove the oldest value
    //console.log(array)
  }
}

  // Initialize data arrays
  var gridPowerData = [];
  var chargerPowerData = [];
  var inveterPowerData = [];

  var chargerCurrentData = [];
  var gridCurrentData = [];
  var inverterCurrentData = [];
  var inverterVoltageData = [];
  var gridVoltageData = [];
  var pvVoltageData = [];
  var timestamps = [];

  // Chart configuration for Grid Power (Area Chart)
  var gridPowerChart = {
    chart: {
      type: 'area',
      height: '100%',
      width: '100%',
    },
    series: [{
      name: 'Grid Power (W)',
      data: gridPowerData,
    }],
    xaxis: {
      categories: timestamps,
      labels: {
        format: 'HH:mm:ss',
      },
    },
    yaxis: {
      title: {
        text: 'Power (W)',
      },
    },
    stroke: {
      curve: 'smooth',
      width: 2,
    },
    grid: {
      show: true,
      borderColor: '#f1f1f1',
      yaxis: {
        lines: {
          show: false,
        },
      },
    },
    fill: {
      type: 'gradient',
      gradient: {
        shadeIntensity: 1,
        opacityFrom: 0.5,
        opacityTo: 0.8,
        stops: [0, 100],
      },
    },
    colors: ['#49BEFF'],
    tooltip: {
      theme: 'dark',
      x: {
        format: 'HH:mm:ss',
      },
    },
  };

  var chart1 = new ApexCharts(document.querySelector("#gridPowerChart"), gridPowerChart);
  chart1.render();

  // Chart configuration for Charger Power (Area Chart)
  var chargerPowerChart = {
    chart: {
      type: 'area',
      height: '100%',
      width: '100%',
    },
    series: [{
      name: 'Charger Power (W)',
      data: chargerPowerData,
    }],
    xaxis: {
      categories: timestamps,
      labels: {
        format: 'HH:mm:ss',
      },
    },
    yaxis: {
      title: {
        text: 'Power (W)',
      },
    },
    stroke: {
      curve: 'smooth',
      width: 2,
    },
    grid: {
      show: true,
      borderColor: '#f1f1f1',
      yaxis: {
        lines: {
          show: false,
        },
      },
    },
    fill: {
      type: 'gradient',
      gradient: {
        shadeIntensity: 1,
        opacityFrom: 0.5,
        opacityTo: 0.8,
        stops: [0, 100],
      },
    },
    colors: ['#28a745'],
    tooltip: {
      theme: 'dark',
      x: {
        format: 'HH:mm:ss',
      },
    },
  };

  var chart2 = new ApexCharts(document.querySelector("#chargerPowerChart"), chargerPowerChart);
  chart2.render();

  // Chart configuration for Current Levels (Multi-Line Area Chart)
  var currentChart = {
    chart: {
      type: 'area',
      height: '100%',
      width: '100%',
    },
    series: [
      {
        name: 'Charger Current (A)',
        data: chargerCurrentData,
      },
      {
        name: 'Grid Current (A)',
        data: gridCurrentData,
      },
      {
        name: 'Inverter Current (A)',
        data: inverterCurrentData,
      },
    ],
    xaxis: {
      categories: timestamps,
      labels: {
        format: 'HH:mm:ss',
      },
    },
    yaxis: {
      title: {
        text: 'Current (A)',
      },
    },
    stroke: {
      curve: 'smooth',
      width: 2,
    },
    grid: {
      show: true,
      borderColor: '#f1f1f1',
      yaxis: {
        lines: {
          show: false,
        },
      },
    },
    fill: {
      type: 'gradient',
      gradient: {
        shadeIntensity: 1,
        opacityFrom: 0.5,
        opacityTo: 0.8,
        stops: [0, 100],
      },
    },
    colors: ['#28a745', '#49BEFF', '#FFC107'],
    tooltip: {
      theme: 'dark',
      x: {
        format: 'HH:mm:ss',
      },
    },
  };

  var chartCurrent = new ApexCharts(document.querySelector("#currentChart"), currentChart);
  chartCurrent.render();

  // Chart configuration for Voltage Levels (Multi-Line Area Chart)
  var voltageChart = {
    chart: {
      type: 'area',
      height: '100%',
      width: '100%',
    },
    series: [
      {
        name: 'Inverter Voltage (V)',
        data: inverterVoltageData,
      },
      {
        name: 'Grid Voltage (V)',
        data: gridVoltageData,
      },
      {
        name: 'PV Voltage (V)',
        data: pvVoltageData,
      },
    ],
    xaxis: {
      categories: timestamps,
      labels: {
        format: 'HH:mm:ss',
      },
    },
    yaxis: {
      title: {
        text: 'Voltage (V)',
      },
    },
    stroke: {
      curve: 'smooth',
      width: 2,
    },
    grid: {
      show: true,
      borderColor: '#f1f1f1',
      yaxis: {
        lines: {
          show: false,
        },
      },
    },
    fill: {
      type: 'gradient',
      gradient: {
        shadeIntensity: 1,
        opacityFrom: 0.5,
        opacityTo: 0.8,
        stops: [0, 100],
      },
    },
    colors: ['#FF4560', '#775DD0', '#00E396'],
    tooltip: {
      theme: 'dark',
      x: {
        format: 'HH:mm:ss',
      },
    },
  };

  var chartVoltage = new ApexCharts(document.querySelector("#voltageChart"), voltageChart);
  chartVoltage.render();





 // Chart configuration for Load vs. Usage (Combined Bar Chart)
  var powerUsageChartOptions = {
    chart: {
      type: 'bar',
      height: '100%',
      width: '100%',
      stacked: true,
    },
    series: [
      {
        name: 'Grid Power(W)',
        data: gridPowerData,//change to invetere as well
      },
      {
        name: 'Generated (PV) Power(W)',
        data: chargerPowerData,
      },
      {
        name: 'Inveter Power(W)',
        data: inveterPowerData,
      }
    ],
    xaxis: {
      categories: timestamps,
    },
    yaxis: {
      title: {
        text: 'Usage / Generated ',
      },
    },
    fill: {
      opacity: 1,
    },
    colors: ['#4297a0', '#e57f84','#145da0'],
    tooltip: {
      theme: 'dark',
    },
  };

  var powerUsageChart = new ApexCharts(document.querySelector("#powerUsageChart"), powerUsageChartOptions);
  powerUsageChart.render();

    var radialBarChart = {
    chart: {
      type: 'radialBar',
      height: '100%',
      width: '100%',
      offsetY: -10,
    },
    plotOptions: {
      radialBar: {
        startAngle: -90,
        endAngle: 90,
        track: {
          background: '#e6e6e6', // Track color
          strokeWidth: '100%',
        },
        dataLabels: {
          name: {
            fontSize: '16px',
            color: undefined,
            offsetY: 120,
          },
          value: {
            fontSize: '24px',
            color: '#111',
            offsetY: 30,
            formatter: function (val) {
              return val + "%"; // Format value as percentage
            },
          },
          total: {
            show: true,
            label: 'Last Updated',
            formatter: function () {
              return '0%'; // Default total value
            },
          },
        },
      },
    },
    colors: ['#28a745', '#ffc107'], // Default green, yellow will be handled by custom logic
    series: [0], // Initial value, will be updated
    labels: ['Load Percentage'], // Label for the chart
  };

  var loadPiechart = new ApexCharts(document.querySelector("#loadPercentChart"), radialBarChart);
  loadPiechart.render();



  // Socket.IO for live updates
  
  //const socket = io('127.0.0.1:3000');
  //const socket = io('http://192.168.0.129:3000');
  //const socket = io('https://virtual-power-plant-emulation.onrender.com');

  // Initialize the socket connection
  //const socket = io('http://localhost:3000'); // Replace with your server's address

// Emit a message to itself using an ordinary function
function emitData() {
  const data = [
    [2, 230, 3000, 0, 273, 2302, 0, 4199, 10, 6, 0, 6, 194, 0, 194, 6, 230, 0, 194, 0, 123, 0, 122, 0, 5000, 0, 0, 0, 0, 0, 0, 0, 40, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3492, 0, 0, 0, 0, 1, 959, 0, 3492, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65268, 65527, 24, 0, 3000, 10414, 119, 2, 2, 2, 0, 980, 270, 197, 530, 41, 0, 1, 1, 0, 0, 24, 600, 1, 1760, 0, 0, 0],
    [2, 230, 3000, 0, 273, 2302, 0, 4199, 10, 6, 0, 6, 194, 0, 194, 6, 230, 0, 194, 0, 122, 0, 122, 0, 5000, 0, 0, 0, 0, 0, 0, 0, 40, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3492, 0, 0, 0, 0, 1, 959, 0, 3492, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65268, 65527, 24, 0, 3000, 10414, 119, 2, 2, 2, 0, 980, 270, 198, 530, 41, 0, 1, 1, 0, 0, 24, 600, 1, 1760, 0, 0, 0],
    [2, 230, 3000, 0, 273, 2302, 0, 4199, 10, 6, 0, 6, 196, 0, 193, 6, 230, 0, 193, 0, 124, 0, 125, 0, 5000, 0, 0, 0, 0, 0, 0, 0, 40, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3492, 0, 0, 0, 0, 1, 959, 0, 3492, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65270, 65527, 24, 0, 3000, 10414, 119, 2, 2, 2, 0, 980, 270, 193, 528, 41, 0, 1, 1, 0, 0, 24, 600, 1, 1760, 0, 0, 0],
    [2, 230, 3000, 0, 273, 2302, 0, 4199, 10, 6, 0, 6, 193, 0, 193, 6, 230, 0, 193, 0, 124, 0, 124, 0, 5000, 0, 0, 0, 0, 0, 0, 0, 40, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3492, 0, 0, 0, 0, 1, 959, 0, 3492, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65275, 65527, 24, 0, 3000, 10414, 119, 2, 2, 2, 0, 980, 270, 196, 522, 41, 0, 1, 1, 0, 0, 24, 600, 1, 1760, 0, 0, 0],
    [2, 230, 3000, 0, 273, 2302, 0, 4199, 10, 6, 0, 6, 193, 0, 193, 6, 230, 0, 193, 0, 124, 0, 124, 0, 5000, 0, 0, 0, 0, 0, 0, 0, 40, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3492, 0, 0, 0, 0, 1, 959, 0, 3492, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65272, 65527, 24, 0, 3000, 10414, 119, 2, 2, 2, 0, 979, 270, 197, 525, 41, 0, 1, 1, 0, 0, 24, 600, 1, 1760, 0, 0, 0],
    [2, 230, 3000, 0, 273, 2302, 0, 4199, 10, 6, 0, 6, 192, 0, 192, 6, 230, 0, 192, 0, 125, 0, 125, 0, 5000, 0, 0, 0, 0, 0, 0, 0, 40, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3492, 0, 0, 0, 0, 1, 959, 0, 3492, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65266, 65527, 24, 0, 3000, 10414, 119, 2, 2, 2, 0, 979, 270, 196, 534, 41, 0, 1, 1, 0, 0, 24, 600, 1, 1760, 0, 0, 0],
    [2, 230, 3000, 0, 273, 2302, 0, 4199, 10, 6, 0, 6, 191, 0, 192, 6, 230, 0, 192, 0, 125, 0, 125, 0, 5000, 0, 0, 0, 0, 0, 0, 0, 40, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3492, 0, 0, 0, 0, 1, 959, 0, 3492, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65272, 65527, 24, 0, 3000, 10414, 119, 2, 2, 2, 0, 979, 270, 196, 522, 41, 0, 1, 1, 0, 0, 24, 600, 1, 1760, 0, 0, 0],
    [2, 230, 3000, 0, 273, 2302, 0, 4199, 10, 6, 0, 6, 192, 0, 191, 6, 230, 0, 191, 0, 125, 0, 125, 0, 5000, 0, 0, 0, 0, 0, 0, 0, 40, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3492, 0, 0, 0, 0, 1, 959, 0, 3492, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65274, 65527, 24, 0, 3000, 10414, 119, 2, 2, 2, 0, 980, 270, 196, 522, 41, 0, 1, 1, 0, 0, 24, 600, 1, 1760, 0, 0, 0],
    [2, 230, 3000, 0, 273, 2302, 0, 4199, 10, 6, 0, 6, 193, 0, 190, 6, 230, 0, 190, 0, 128, 0, 128, 0, 5000, 0, 0, 0, 0, 0, 0, 0, 40, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3492, 0, 0, 0, 0, 1, 959, 0, 3492, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65270, 65527, 24, 0, 3000, 10414, 119, 2, 2, 2, 0, 979, 270, 195, 527, 41, 0, 1, 1, 0, 0, 24, 600, 1, 1760, 0, 0, 0],
    [2, 230, 3000, 0, 273, 2302, 0, 4199, 10, 6, 0, 6, 193, 0, 191, 6, 230, 0, 191, 0, 126, 0, 127, 0, 5000, 0, 0, 0, 0, 0, 0, 0, 40, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3492, 0, 0, 0, 0, 1, 959, 0, 3492, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65266, 65527, 24, 0, 3000, 10414, 119, 2, 2, 2, 0, 979, 270, 195, 530, 41, 0, 1, 1, 0, 0, 24, 600, 1, 1760, 0, 0, 0],

    [6, 230, 3000, 0, 270, 0, 2400, 4356, 0, 0, 17, 17, 0, 237, 237, 7, 0, 407, 405, 0, 0, 329, 329, 0, 4979, 4979, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65211, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 990, 267, 121, 325, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 271, 0, 2397, 4356, 0, 0, 17, 17, 0, 235, 235, 7, 0, 407, 405, 0, 0, 331, 331, 0, 4980, 4980, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65211, 65525, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 990, 267, 119, 325, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2400, 4356, 0, 0, 17, 17, 0, 238, 237, 7, 0, 407, 405, 0, 0, 330, 330, 0, 4981, 4981, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65215, 65525, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 993, 267, 121, 321, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2395, 4356, 0, 0, 17, 17, 0, 237, 235, 7, 0, 407, 404, 0, 0, 329, 329, 0, 4981, 4981, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65208, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 994, 267, 121, 328, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2396, 4356, 0, 0, 17, 17, 0, 236, 236, 7, 0, 407, 405, 0, 0, 331, 331, 0, 4981, 4981, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65213, 65525, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 994, 267, 125, 329, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2398, 4356, 0, 0, 17, 17, 0, 237, 237, 7, 0, 406, 404, 0, 0, 329, 329, 0, 4980, 4980, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65209, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 996, 267, 120, 327, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 271, 0, 2399, 4356, 0, 0, 17, 17, 0, 235, 235, 7, 0, 407, 405, 0, 0, 331, 331, 0, 4982, 4982, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65216, 65525, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 998, 267, 124, 326, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2395, 4356, 0, 0, 17, 17, 0, 237, 237, 7, 0, 407, 405, 0, 0, 330, 329, 0, 4981, 4981, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65212, 65525, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 999, 267, 123, 324, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2400, 4356, 0, 0, 17, 17, 0, 239, 239, 7, 0, 407, 405, 0, 0, 328, 329, 0, 4981, 4981, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65210, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1002, 267, 120, 326, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 271, 0, 2403, 4356, 0, 0, 17, 17, 0, 236, 236, 7, 0, 408, 406, 0, 0, 331, 331, 0, 4980, 4980, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65205, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1004, 267, 124, 331, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 271, 0, 2396, 4356, 0, 0, 17, 17, 0, 237, 237, 7, 0, 406, 404, 0, 0, 329, 329, 0, 4982, 4982, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65205, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1007, 267, 123, 331, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 271, 0, 2399, 4356, 0, 0, 17, 17, 0, 238, 238, 8, 0, 407, 405, 0, 0, 329, 329, 0, 4983, 4983, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65208, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1007, 267, 124, 328, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2401, 4356, 0, 0, 17, 17, 0, 235, 237, 8, 0, 407, 405, 0, 0, 332, 330, 0, 4986, 4986, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65207, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1007, 267, 125, 329, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2401, 4356, 0, 0, 17, 17, 0, 238, 235, 8, 0, 408, 406, 0, 0, 332, 332, 0, 4989, 4989, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65200, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1006, 267, 124, 326, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2399, 4356, 0, 0, 17, 17, 0, 236, 236, 7, 0, 407, 405, 0, 0, 331, 331, 0, 4989, 4989, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65200, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1006, 267, 125, 336, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2399, 4356, 0, 0, 17, 17, 0, 236, 236, 7, 0, 407, 405, 0, 0, 331, 331, 0, 4987, 4987, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65211, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1005, 267, 121, 325, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2398, 4356, 0, 0, 17, 17, 0, 237, 237, 8, 0, 407, 405, 0, 0, 330, 330, 0, 4988, 4988, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65198, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1006, 267, 125, 338, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2398, 4356, 0, 0, 17, 17, 0, 243, 239, 7, 0, 406, 404, 0, 0, 325, 328, 0, 4988, 4988, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65200, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1008, 267, 124, 336, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2396, 4356, 0, 0, 17, 17, 0, 234, 233, 7, 0, 406, 404, 0, 0, 331, 331, 0, 4988, 4988, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65201, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1006, 267, 123, 331, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2398, 4356, 0, 0, 17, 17, 0, 235, 235, 7, 0, 407, 408, 0, 0, 330, 330, 0, 4990, 4990, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65207, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1006, 267, 124, 329, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2397, 4356, 0, 0, 17, 17, 0, 235, 235, 7, 0, 406, 404, 0, 0, 331, 331, 0, 4989, 4989, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65203, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1006, 267, 123, 328, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2396, 4356, 0, 0, 17, 17, 0, 235, 235, 7, 0, 407, 405, 0, 0, 331, 331, 0, 4985, 4985, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65210, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1006, 267, 124, 326, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2395, 4356, 0, 0, 17, 17, 0, 236, 236, 7, 0, 406, 404, 0, 0, 330, 330, 0, 4985, 4985, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65204, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1004, 267, 121, 332, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 271, 0, 2397, 4356, 0, 0, 17, 17, 0, 236, 236, 7, 0, 407, 405, 0, 0, 330, 330, 0, 4986, 4986, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65214, 65525, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1007, 267, 124, 322, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 271, 0, 2394, 4357, 0, 0, 17, 17, 0, 235, 235, 7, 0, 406, 404, 0, 0, 330, 330, 0, 4984, 4984, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65210, 65524, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1006, 267, 123, 326, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0],
[6, 230, 3000, 0, 270, 0, 2395, 4356, 0, 0, 17, 17, 0, 235, 235, 7, 0, 406, 404, 0, 0, 329, 329, 0, 4985, 4985, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 3515, 0, 0, 0, 0, 1, 1002, 0, 3515, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 10101, 22535, 65217, 65525, 24, 0, 3000, 10414, 639, 2, 1, 1, 0, 1007, 267, 124, 319, 31, 0, 1, 1, 0, 0, 24, 600, 1, 1794, 0, 0, 0]


  ];
  const randomIndex = Math.floor(Math.random() * data.length);
  processData(data[randomIndex]);
}

setInterval(emitData, 5000);

function processData(data) {

    console.log("accumulated power" + data[96])
    console.log('PInverter : ' +data[12].toFixed(2)+'. PGrid : '+data[13].toFixed(2)+'. PLoad : '+data[14].toFixed(2))
    const gridPower       = data[13].toFixed(2);
    const chargerPower    = data[86].toFixed(2);
    const inveterPower    = data[12].toFixed(2);

    const chargerCurrent  = (data[85] * 0.1).toFixed(2);
    const gridCurrent     = (data[10] * 0.1).toFixed(2);
    const inverterCurrent = (data[9] * 0.1).toFixed(2);
    const inverterVoltage = (data[5] * 0.1).toFixed(2);
    const gridVoltage     = (data[6] * 0.1).toFixed(2);
    const pvVoltage       = (data[83] * 0.1).toFixed(2);

    const loadPercent     = data[15].toFixed(2); // Assuming load percentage data is at index 15
    const powerUsage      = (data[14] * 1).toFixed(2); // Assuming power usage data is at index 14
    const pvGeneration    = (data[83] * 1).toFixed(2); // Assuming PV generation data is at index 83

	

    // Optionally, update PV Generation data if needed for visualization
    // powerUsageData.push(pvGeneration); // Uncomment if you want to display PV Generation

    
    
    const timestamp = new Date().toLocaleTimeString();
  const accumulatedPower1 = (data[96] * 0.1).toFixed(4)
  const accumulatedPower = (accumulatedPower1-519).toFixed(4)
 const cardTitle = document.querySelector('.card-title.fw-semibold');
cardTitle.innerHTML = `
  <strong>Inverter Load:</strong> ${loadPercent}%<br>
  <strong>Last Updated:</strong> ${timestamp}<br>
  
`;



const arrayLength = 25
     // Maintain array lengths
  maintainArrayLength(timestamps, arrayLength);
  maintainArrayLength(gridPowerData, arrayLength);
  maintainArrayLength(chargerPowerData, arrayLength);
  maintainArrayLength(inveterPowerData, arrayLength);
  maintainArrayLength(chargerCurrentData, arrayLength);
  maintainArrayLength(gridCurrentData, arrayLength);
  maintainArrayLength(inverterCurrentData, arrayLength);
  maintainArrayLength(inverterVoltageData, arrayLength);
  maintainArrayLength(gridVoltageData, arrayLength);
  maintainArrayLength(pvVoltageData, arrayLength);

    // Update timestamps and data arrays
    timestamps.push(timestamp);
    gridPowerData.push(gridPower);
    chargerPowerData.push(chargerPower);
    inveterPowerData.push(inveterPower);
    chargerCurrentData.push(chargerCurrent);
    gridCurrentData.push(gridCurrent);
    inverterCurrentData.push(inverterCurrent);
    inverterVoltageData.push(inverterVoltage);
    gridVoltageData.push(gridVoltage);
    pvVoltageData.push(pvVoltage);

    // Update Grid Power chart
    chart1.updateSeries([{ data: gridPowerData }]);
    chart1.updateOptions({ xaxis: { categories: timestamps } });

    // Update Charger Power chart
    chart2.updateSeries([{ data: chargerPowerData }]);
    chart2.updateOptions({ xaxis: { categories: timestamps } });

    // Update Current Chart
    chartCurrent.updateSeries([
      { data: chargerCurrentData },
      { data: gridCurrentData },
      { data: inverterCurrentData },
    ]);
    chartCurrent.updateOptions({ xaxis: { categories: timestamps } });

    // Update Voltage Chart
    chartVoltage.updateSeries([
      { data: inverterVoltageData },
      { data: gridVoltageData },
      { data: pvVoltageData },
    ]);
    chartVoltage.updateOptions({ xaxis: { categories: timestamps } });


    // Update Voltage Chart
    powerUsageChart.updateSeries([
      { data: gridPowerData },
      { data: chargerPowerData },
      { data: inveterPowerData }
      
    ]);
    powerUsageChart.updateOptions({ xaxis: { categories: timestamps } });


     // Determine color based on value
    let color = '#28a745'; // Default green
    if (loadPercent >= 15 && loadPercent <= 45) {
      color = '#ffc107'; // Yellow
    }

      // Update the chart with new data
    loadPiechart.updateOptions({
      colors: [color], // Update the chart color dynamically
      series: [loadPercent], // Update the value
      plotOptions: {
        radialBar: {
          dataLabels: {
            total: {
              show: true,
              label: '',
              formatter: function () {
                return `${loadPercent}% `; // Show the current percentage and timestamp
              },
            },
          },
        },
      },
    })

  };


</script>




  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-GVRPV64YPR"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-GVRPV64YPR');
  </script>
</body>

</html>